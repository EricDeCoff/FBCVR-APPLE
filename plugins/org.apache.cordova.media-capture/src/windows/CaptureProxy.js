function MediaCaptureProxy(){function e(){var e=Array.prototype.slice.call(arguments);e.forEach(function(e){var t=document.getElementById(e);if(t){var r=t.style.display;t.style.display="none"===r?"block":"none"}})}function t(){var e="margin: 7px; border: 2.5px solid white; width: 45%; height: 35px; color: white; background-color: black;";o=document.createElement("div"),o.style.cssText="background-position: 50% 50%; background-repeat: no-repeat; background-size: contain; background-color: black; left: 0px; top: 0px; width: 100%; height: 100%; position: fixed; z-index: 9999",o.innerHTML='<video id="capturePreview" style="width: 100%; height: 100%"></video><div id="previewButtons" style="width: 100%; bottom: 0px; display: flex; position: absolute; justify-content: space-around; background-color: black;"><button id="takePicture" style="'+e+'">Capture</button><button id="cancelCapture" style="'+e+'">Cancel</button><button id="selectPicture" style="display: none; '+e+'">Accept</button><button id="retakePicture" style="display: none; '+e+'">Retake</button></div>',document.body.appendChild(o),u=document.getElementById("capturePreview"),c=document.getElementById("cancelCapture"),l=new s.MediaCapture,d=new s.MediaCaptureInitializationSettings,d.streamingCaptureMode=s.StreamingCaptureMode.audioAndVideo}function r(e,t,r,n){var i=Windows.Devices.Enumeration.Panel.back;Windows.Devices.Enumeration.DeviceInformation.findAllAsync(Windows.Devices.Enumeration.DeviceClass.videoCapture).done(function(c){c.length>0?(c.forEach(function(e){e.enclosureLocation&&e.enclosureLocation.panel&&e.enclosureLocation.panel==i&&(d.videoDeviceId=e.id)}),l.initializeAsync(d).done(function(){l.setPreviewRotation(Windows.Media.Capture.VideoRotation.clockwise90Degrees),u.msZoom=!0,u.src=URL.createObjectURL(l),u.play(),o.style.display="block",u.onclick=e,document.getElementById("takePicture").onclick=e,document.getElementById("cancelCapture").onclick=function(){t(CaptureError.CAPTURE_NO_MEDIA_FILES)},document.getElementById("selectPicture").onclick=r,document.getElementById("retakePicture").onclick=n},function(e){a(),t(CaptureError.CAPTURE_INTERNAL_ERR,e)})):(a(),t(CaptureError.CAPTURE_INTERNAL_ERR))})}function a(){u.pause(),u.src=null,o&&document.body.removeChild(o),l&&(l.stopRecordAsync(),l=null)}var o,n,i,u=null,c=null,d=null,p=!1,l=null,s=Windows.Media.Capture;return{captureVideo:function(o,n){try{t(),r(function(){if(p)l.stopRecordAsync().done(function(){a(),o(i)});else{e("cancelCapture"),document.getElementById("takePicture").text="Stop";var t=Windows.Media.MediaProperties.MediaEncodingProfile.createMp4(Windows.Media.MediaProperties.VideoEncodingQuality.auto),r=Windows.Storage.CreationCollisionOption.generateUniqueName,u=Windows.Storage.ApplicationData.current.localFolder;u.createFileAsync("cameraCaptureVideo.mp4",r).done(function(e){l.startRecordToStorageFileAsync(t,e).done(function(){i=e,p=!0},function(e){a(),n(CaptureError.CAPTURE_INTERNAL_ERR,e)})},function(e){a(),n(CaptureError.CAPTURE_INTERNAL_ERR,e)})}},n)}catch(u){a(),n(CaptureError.CAPTURE_INTERNAL_ERR,u)}},capturePhoto:function(i,u){try{t(),r(function(){var t=Windows.Media.MediaProperties.ImageEncodingProperties.createJpeg(),r=Windows.Storage.CreationCollisionOption.replaceExisting,i=Windows.Storage.ApplicationData.current.temporaryFolder;i.createFileAsync("cameraCaptureImage.jpg",r).done(function(r){l.capturePhotoToStorageFileAsync(t,r).done(function(){n=r,o.style.backgroundImage='url("ms-appdata:///temp/'+r.name+'")',e("capturePreview","takePicture","cancelCapture","selectPicture","retakePicture")},function(e){a(),u(CaptureError.CAPTURE_INTERNAL_ERR,e)})},function(e){a(),u(CaptureError.CAPTURE_INTERNAL_ERR,e)})},function(e){a(),u(e)},function(){var e=Windows.Storage.CreationCollisionOption.generateUniqueName,t=Windows.Storage.ApplicationData.current.localFolder;n.copyAsync(t,n.name,e).done(function(e){a(),i(e)},function(e){a(),u(e)})},function(){e("capturePreview","takePicture","cancelCapture","selectPicture","retakePicture")})}catch(c){a(),u(CaptureError.CAPTURE_INTERNAL_ERR,c)}}}}var MediaFile=require("org.apache.cordova.media-capture.MediaFile"),CaptureError=require("org.apache.cordova.media-capture.CaptureError"),CaptureAudioOptions=require("org.apache.cordova.media-capture.CaptureAudioOptions"),CaptureImageOptions=require("org.apache.cordova.media-capture.CaptureImageOptions"),CaptureVideoOptions=require("org.apache.cordova.media-capture.CaptureVideoOptions"),MediaFileData=require("org.apache.cordova.media-capture.MediaFileData");module.exports={captureAudio:function(e,t,r){var a=r[0],o=new CaptureAudioOptions;if("undefined"==typeof a.duration)o.duration=3600;else{if(!(a.duration>0))return void t(new CaptureError(CaptureError.CAPTURE_INVALID_ARGUMENT));o.duration=a.duration}var n=Windows.Media.Capture,i=Windows.Media.MediaProperties,u=Windows.Storage.ApplicationData.current.localFolder,c=Windows.Storage.NameCollisionOption.generateUniqueName,d=new n.MediaCapture,p=new n.MediaCaptureInitializationSettings,l=new i.MediaEncodingProfile.createMp3(i.AudioEncodingQuality.auto),s=new i.MediaEncodingProfile.createM4a(i.AudioEncodingQuality.auto);p.streamingCaptureMode=n.StreamingCaptureMode.audio;var C,E,m=function(){d.stopRecordAsync().then(function(){C.getBasicPropertiesAsync().then(function(t){var r=new MediaFile(C.name,"ms-appdata:///local/"+C.name,C.contentType,t.dateModified,t.size);r.fullPath=C.path,e([r])},function(){t(new CaptureError(CaptureError.CAPTURE_NO_MEDIA_FILES))})},function(){t(new CaptureError(CaptureError.CAPTURE_NO_MEDIA_FILES))})};d.initializeAsync(p).done(function(){u.createFileAsync("captureAudio.mp3",c).then(function(e){C=e,d.startRecordToStorageFileAsync(l,C).then(function(){E=setTimeout(m,1e3*o.duration)},function(e){return-1072868846!==e.number?void t(new CaptureError(CaptureError.CAPTURE_INTERNAL_ERR)):(clearTimeout(E),void u.createFileAsync("captureAudio.m4a",c).then(function(e){C=e,d.startRecordToStorageFileAsync(s,C).then(function(){E=setTimeout(m,1e3*o.duration)},function(){t(new CaptureError(CaptureError.CAPTURE_INTERNAL_ERR))})}))})},function(){t(new CaptureError(CaptureError.CAPTURE_NO_MEDIA_FILES))})})},captureImage:function(e,t,r){function a(e,r){var a=new CaptureError(e);a.message=r,t(a)}var o=(r[0],Windows.Media.Capture);if(o.CameraCaptureUI){var n=(new CaptureImageOptions,new Windows.Media.Capture.CameraCaptureUI);n.photoSettings.allowCropping=!0,n.photoSettings.maxResolution=Windows.Media.Capture.CameraCaptureUIMaxPhotoResolution.highestAvailable,n.photoSettings.format=Windows.Media.Capture.CameraCaptureUIPhotoFormat.jpeg,n.captureFileAsync(Windows.Media.Capture.CameraCaptureUIMode.photo).done(function(r){r.moveAsync(Windows.Storage.ApplicationData.current.localFolder,"cameraCaptureImage.jpg",Windows.Storage.NameCollisionOption.generateUniqueName).then(function(){r.getBasicPropertiesAsync().then(function(t){var a=new MediaFile(r.name,"ms-appdata:///local/"+r.name,r.contentType,t.dateModified,t.size);a.fullPath=r.path,e([a])},function(){t(new CaptureError(CaptureError.CAPTURE_NO_MEDIA_FILES))})},function(){t(new CaptureError(CaptureError.CAPTURE_NO_MEDIA_FILES))})},function(){t(new CaptureError(CaptureError.CAPTURE_NO_MEDIA_FILES))})}else{var i=new MediaCaptureProxy;i.capturePhoto(function(t){t.getBasicPropertiesAsync().done(function(r){var a=new MediaFile(t.name,"ms-appdata:///local/"+t.name,t.contentType,r.dateModified,r.size);a.fullPath=t.path,e([a])},function(e){a(CaptureError.CAPTURE_INTERNAL_ERR,e)})},function(e){a(e)})}},captureVideo:function(e,t,r){function a(e,r){var a=new CaptureError(e);a.message=r,t(a)}var o=r[0],n=Windows.Media.Capture;if(n.CameraCaptureUI){var i=new CaptureVideoOptions;o.duration&&o.duration>0&&(i.duration=o.duration),o.limit>1&&(i.limit=o.limit);var u=new Windows.Media.Capture.CameraCaptureUI;u.videoSettings.allowTrimming=!0,u.videoSettings.format=Windows.Media.Capture.CameraCaptureUIVideoFormat.mp4,u.videoSettings.maxDurationInSeconds=i.duration,u.captureFileAsync(Windows.Media.Capture.CameraCaptureUIMode.video).then(function(r){r.moveAsync(Windows.Storage.ApplicationData.current.localFolder,"cameraCaptureVideo.mp4",Windows.Storage.NameCollisionOption.generateUniqueName).then(function(){r.getBasicPropertiesAsync().then(function(t){var a=new MediaFile(r.name,"ms-appdata:///local/"+r.name,r.contentType,t.dateModified,t.size);a.fullPath=r.path,e([a])},function(){t(new CaptureError(CaptureError.CAPTURE_NO_MEDIA_FILES))})},function(){t(new CaptureError(CaptureError.CAPTURE_NO_MEDIA_FILES))})},function(){t(new CaptureError(CaptureError.CAPTURE_NO_MEDIA_FILES))})}else{var c=new MediaCaptureProxy;c.captureVideo(function(t){t.getBasicPropertiesAsync().done(function(r){var a=new MediaFile(t.name,"ms-appdata:///local/"+t.name,t.contentType,r.dateModified,r.size);a.fullPath=t.path,e([a])},function(e){a(CaptureError.CAPTURE_INTERNAL_ERR,e)})},a)}},getFormatData:function(e,t,r){Windows.Storage.StorageFile.getFileFromPathAsync(r[0]).then(function(r){var a=String(r.contentType).split("/")[0].toLowerCase();"audio"===a?r.properties.getMusicPropertiesAsync().then(function(t){e(new MediaFileData(null,t.bitrate,0,0,t.duration/1e3))},function(){t(new CaptureError(CaptureError.CAPTURE_INVALID_ARGUMENT))}):"video"===a?r.properties.getVideoPropertiesAsync().then(function(t){e(new MediaFileData(null,t.bitrate,t.height,t.width,t.duration/1e3))},function(){t(new CaptureError(CaptureError.CAPTURE_INVALID_ARGUMENT))}):"image"===a?r.properties.getImagePropertiesAsync().then(function(t){e(new MediaFileData(null,0,t.height,t.width,0))},function(){t(new CaptureError(CaptureError.CAPTURE_INVALID_ARGUMENT))}):t(new CaptureError(CaptureError.CAPTURE_INVALID_ARGUMENT))},function(){t(new CaptureError(CaptureError.CAPTURE_INVALID_ARGUMENT))})}},require("cordova/exec/proxy").add("Capture",module.exports);