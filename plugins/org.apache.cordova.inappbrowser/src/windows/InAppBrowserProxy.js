function attachNavigationEvents(t,e){if(isWebViewAvailable)t.addEventListener("MSWebViewNavigationStarting",function(t){e({type:"loadstart",url:t.uri},{keepCallback:!0})}),t.addEventListener("MSWebViewNavigationCompleted",function(t){e({type:t.isSuccess?"loadstop":"loaderror",url:t.uri},{keepCallback:!0})}),t.addEventListener("MSWebViewUnviewableContentIdentified",function(t){e({type:"loaderror",url:t.uri},{keepCallback:!0})}),t.addEventListener("MSWebViewContentLoading",function(){navigationButtonsDiv&&(backButton.disabled=!popup.canGoBack,forwardButton.disabled=!popup.canGoForward)});else{var n=function(){e({type:"loaderror",url:this.contentWindow.location},{keepCallback:!0})};t.addEventListener("unload",function(){e({type:"loadstart",url:this.contentWindow.location},{keepCallback:!0})}),t.addEventListener("load",function(){e({type:"loadstop",url:this.contentWindow.location},{keepCallback:!0})}),t.addEventListener("error",n),t.addEventListener("abort",n)}}var cordova=require("cordova"),channel=require("cordova/channel"),urlutil=require("cordova/urlutil"),browserWrap,popup,navigationButtonsDiv,navigationButtonsDivInner,backButton,forwardButton,closeButton,isWebViewAvailable="windows"==cordova.platformId,IAB={close:function(t){browserWrap&&(t&&t({type:"exit"}),browserWrap.parentNode.removeChild(browserWrap),browserWrap=null,popup=null)},show:function(){browserWrap&&(browserWrap.style.display="block")},open:function(t,e,n){var o,i=n[0],a=n[1],r=n[2];"_system"===a?(o=new Windows.Foundation.Uri(i),Windows.System.Launcher.launchUriAsync(o)):"_self"!==a&&a?(browserWrap||(browserWrap=document.createElement("div"),browserWrap.style.position="absolute",browserWrap.style.borderWidth="40px",browserWrap.style.width="calc(100% - 80px)",browserWrap.style.height="calc(100% - 80px)",browserWrap.style.borderStyle="solid",browserWrap.style.borderColor="rgba(0,0,0,0.25)",browserWrap.onclick=function(){setTimeout(function(){IAB.close(t)},0)},document.body.appendChild(browserWrap)),-1!==r.indexOf("hidden=yes")&&(browserWrap.style.display="none"),popup=document.createElement(isWebViewAvailable?"x-ms-webview":"iframe"),popup.style.borderWidth="0px",popup.style.width="100%",browserWrap.appendChild(popup),-1!==r.indexOf("location=yes")||-1===r.indexOf("location")?(popup.style.height="calc(100% - 60px)",navigationButtonsDiv=document.createElement("div"),navigationButtonsDiv.style.height="60px",navigationButtonsDiv.style.backgroundColor="#404040",navigationButtonsDiv.style.zIndex="999",navigationButtonsDiv.onclick=function(t){t.cancelBubble=!0},navigationButtonsDivInner=document.createElement("div"),navigationButtonsDivInner.style.paddingTop="10px",navigationButtonsDivInner.style.height="50px",navigationButtonsDivInner.style.width="160px",navigationButtonsDivInner.style.margin="0 auto",navigationButtonsDivInner.style.backgroundColor="#404040",navigationButtonsDivInner.style.zIndex="999",navigationButtonsDivInner.onclick=function(t){t.cancelBubble=!0},backButton=document.createElement("button"),backButton.style.width="40px",backButton.style.height="40px",backButton.style.borderRadius="40px",backButton.innerText="<-",backButton.addEventListener("click",function(){popup.canGoBack&&popup.goBack()}),forwardButton=document.createElement("button"),forwardButton.style.marginLeft="20px",forwardButton.style.width="40px",forwardButton.style.height="40px",forwardButton.style.borderRadius="40px",forwardButton.innerText="->",forwardButton.addEventListener("click",function(){popup.canGoForward&&popup.goForward()}),closeButton=document.createElement("button"),closeButton.style.marginLeft="20px",closeButton.style.width="40px",closeButton.style.height="40px",closeButton.style.borderRadius="40px",closeButton.innerText="x",closeButton.addEventListener("click",function(){setTimeout(function(){IAB.close(t)},0)}),isWebViewAvailable||(backButton.disabled=!0,forwardButton.disabled=!0),navigationButtonsDivInner.appendChild(backButton),navigationButtonsDivInner.appendChild(forwardButton),navigationButtonsDivInner.appendChild(closeButton),navigationButtonsDiv.appendChild(navigationButtonsDivInner),browserWrap.appendChild(navigationButtonsDiv)):popup.style.height="100%",attachNavigationEvents(popup,t),isWebViewAvailable&&(i=i.replace("ms-appx://","ms-appx-web://")),popup.src=i):window.location=i},injectScriptCode:function(t,e,n){var o=n[0],i=n[1];if(isWebViewAvailable&&browserWrap&&popup){var a=popup.invokeScriptAsync("eval",o);a.oncomplete=function(){i&&t([])},a.onerror=function(){},a.start()}},injectScriptFile:function(t,e,n){var o=n[0],i=n[1];if(o&&(o=urlutil.makeAbsolute(o)),isWebViewAvailable&&browserWrap&&popup){var a=new Windows.Foundation.Uri(o);Windows.Storage.StorageFile.getFileFromApplicationUriAsync(a).done(function(e){Windows.Storage.FileIO.readTextAsync(e).done(function(e){var n=popup.invokeScriptAsync("eval",e);n.oncomplete=function(){i&&t([])},n.onerror=function(){},n.start()})})}}};module.exports=IAB,require("cordova/exec/proxy").add("InAppBrowser",module.exports);